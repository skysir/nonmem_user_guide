$PROBLEM RA
$ABBR DERIV2=NO DERIV2=NOCOMMON ; DERIV1=NO
$ABBR DECLARE DOWHILE IW
$ABBR DECLARE REAL DOSETT(100)
$INPUT ID TIME AMT RATE CMT EVID MDV DV DT1 DT2 DT3
$DATA rad.csv IGNORE=C
$SUBROUTINES ADVAN16 TOL=6 ATOL=6
$MODEL NCOMPARTMENTS=5 

$PK
CL=THETA(1)+ETA(1)
V1=THETA(2)+ETA(2)
CLD=THETA(3)+ETA(3)
V2=THETA(4)+ETA(4)
K1=THETA(5)+ETA(5)
K2=THETA(6)+ETA(6)
K4=THETA(7)+ETA(7)
K5=THETA(8)+ETA(8)
SIG1=THETA(9)+ETA(9)
SIG2=THETA(10)+ETA(10)
SIG3=THETA(11)+ETA(11)
I0=THETA(13)+ETA(13)
Tau1=THETA(12)+ETA(12)
;ALAG4=0.35D+00

;  TAUy
K10=CL/V1
K12=CLD/V1
K21=CLD/V2
K3=5.0
AA=1.0
BB=0.5
; Initial conditions
A_0(1)=AA
A_0(2)=I0

$DES
; AD_x_y is the State value of A(x) delayed for time TAUy.  
; AP_x_y is the State value of A(x) in the past, for time delay TAUy.  

;PAST
AP_1_1=AA*EXP(BB*T)

;BASE EQUATIONS 
CC=A(4)/V1
EFFECT=CC*(SIG1*EXP(-SIG2*CC)+SIG3)

DADT(1)=K3-EFFECT*A(1) - K1/K2* &
(1.0-EXP(-K2*T))*A(1)
DADT(2)=K4*A(1)-K4*AD_1_1
DADT(3)=K4*AD_1_1-K5*A(3)
DADT(4)=-K10*A(4)-K12*A(4)+K21*A(5)
DADT(5)=K12*A(4)-K21*A(5)

$ERROR

Y1=A(2)+A(3)
Y2=A(3)
A1=A(1)
A2=A(2)
A3=A(3)

IPRED=Y1
Y=IPRED*(1.0+EPS(1))

$THETA
0.0096    ; 1: CL
0.02645   ; 2: V1
0.0696    ; 3: CLD
0.0270    ; 4: V2
0.456     ; 5: K1
0.169     ; 6: K2
0.185     ; 7: K4
0.031     ; 8: K5
0.328     ; 9: SIG1
0.328     ; 10: SIG2
0.025     ; 11: SIG3
10.6      ; 12: TAU1
2.83      ; 13: I0

$OMEGA (0.0 FIXED)X13
$SIGMA (0.0 FIXED)

$SIMULATION (567811 NORMAL) ONLYSIMULATION SUBPROBLEMS=1

$TABLE ID TIME Y1 Y2 A1 A2 A3 EVID CMT NOAPPEND NOPRINT ONEHEADER
FILE=RAd.tab FORMAT=s1PE23.16
